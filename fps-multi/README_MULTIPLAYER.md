# FPS 멀티플레이어 가이드

## 🎮 게임 시작하기

### 싱글플레이
1. 메인 메뉴에서 **싱글플레이** 선택
2. 바로 게임 시작!

### 멀티플레이

#### 서버 생성 (호스트)
1. 메인 메뉴에서 **서버 생성** 선택
2. 설정 입력:
   - **서버 이름**: 원하는 서버 이름
   - **포트**: 7777 (기본값, 변경 가능)
   - **최대 인원**: 2-4명
   - **UPNP**: 자동 포트 포워딩 (체크 권장)
3. **생성** 버튼 클릭
4. 로비에서 다른 플레이어 대기
5. 모두 준비되면 **게임 시작**

#### 서버 참가 (클라이언트)
1. 메인 메뉴에서 **서버 참가** 선택
2. 접속 정보 입력:
   - **IP 주소**: 호스트의 IP 주소
   - **포트**: 7777 (호스트와 동일)
3. **참가** 버튼 클릭
4. 로비에서 **준비** 클릭
5. 호스트가 게임 시작할 때까지 대기

## 🌐 네트워크 설정

### 로컬 네트워크 (같은 Wi-Fi)
1. 호스트가 서버 생성
2. 호스트의 로컬 IP 확인:
   - Windows: `ipconfig` 명령어
   - Mac/Linux: `ifconfig` 명령어
   - 예: `192.168.0.5`
3. 클라이언트가 해당 IP로 접속

### 인터넷 (외부 접속)

#### 옵션 1: UPNP (자동)
1. 서버 생성 시 **UPNP 사용** 체크
2. 자동으로 포트 포워딩 시도
3. 성공 시 외부 IP 확인 가능
4. 친구에게 외부 IP 공유

#### 옵션 2: 수동 포트 포워딩
1. 공인 IP 확인 (whatismyip.com)
2. 라우터 설정 페이지 접속
3. 포트 포워딩 설정:
   - 외부 포트: 7777
   - 내부 IP: 자신의 로컬 IP
   - 내부 포트: 7777
   - 프로토콜: UDP
4. Windows 방화벽 설정:
   - 제어판 → 방화벽
   - 인바운드 규칙 → 새 규칙
   - 포트 7777 UDP 허용
5. 친구에게 공인 IP 공유

## 🎯 게임 플레이

### 조작법
- **WASD**: 이동
- **Space**: 점프
- **Shift**: 달리기
- **마우스**: 조준
- **좌클릭**: 발사
- **우클릭**: 조준 (ADS)
- **R**: 재장전
- **1/2/3**: 무기 교체
- **마우스 휠**: 무기 순환

### 멀티플레이어 특징
- 최대 4명 동시 플레이
- 실시간 위치/회전 동기화
- 서버 권한 데미지 시스템 (치팅 방지)
- 플레이어 이름 태그 표시

## 🔧 문제 해결

### 서버 생성 실패
- 포트 7777이 이미 사용 중일 수 있음
- 다른 포트 번호 시도 (예: 7778)
- 방화벽 설정 확인

### 서버 접속 실패
- IP 주소 확인
- 포트 번호 확인
- 호스트의 방화벽 설정 확인
- 포트 포워딩 설정 확인

### 랙/지연
- 인터넷 연결 상태 확인
- 서버 호스트의 업로드 속도 확인
- 플레이어 수 줄이기

### UPNP 실패
- 라우터가 UPNP를 지원하지 않을 수 있음
- 수동 포트 포워딩 사용

## 🔒 보안 주의사항

⚠️ **IP 주소 공개**
- 공인 IP를 공유하면 위치가 노출될 수 있습니다
- 신뢰할 수 있는 친구에게만 공유하세요

⚠️ **방화벽**
- 포트를 열면 보안 위험이 있을 수 있습니다
- 게임 종료 후 포트 포워딩 설정 제거 권장

⚠️ **DDoS 공격**
- 악의적인 사용자가 서버를 공격할 수 있습니다
- 의심스러운 접속은 즉시 차단하세요

## 📊 기술 정보

### 사용 기술
- **Godot 4.5** 멀티플레이어 API
- **ENet** (UDP 프로토콜)
- **호스트-클라이언트** 구조
- **MultiplayerSynchronizer** (자동 동기화)
- **RPC** (원격 함수 호출)

### 동기화 항목
- 플레이어 위치/회전
- 무기 발사
- 데미지/HP
- 게임 상태

### 권한 시스템
- **서버 권한**: HP, 데미지, 게임 시작
- **클라이언트**: 입력, 이동, 시각 효과

## 🎓 개발자 정보

### 테스트 방법
1. **에디터에서 테스트**:
   - 게임 내보내기 (Export)
   - 내보낸 게임 1개 실행
   - 에디터에서 플레이 버튼
   - 하나는 서버, 하나는 클라이언트

2. **로컬 테스트**:
   - IP: `127.0.0.1` (localhost)
   - 두 게임 모두 같은 컴퓨터에서 실행

### 멀티플레이어 확장
- `NetworkManager.gd`에서 설정 변경
- `MAX_CLIENTS` 값 수정 (최대 인원)
- 추가 동기화 항목: player_controller.gd 수정

## 📝 체크리스트

서버 생성 전:
- [ ] 방화벽 설정 확인
- [ ] 포트 번호 결정
- [ ] UPNP 지원 여부 확인
- [ ] 최대 인원 설정

서버 참가 전:
- [ ] 호스트의 IP 주소 받기
- [ ] 포트 번호 확인
- [ ] 안정적인 인터넷 연결

## 🎉 즐거운 게임 되세요!

문제가 발생하면 호스트와 클라이언트 모두 게임을 재시작해보세요.

